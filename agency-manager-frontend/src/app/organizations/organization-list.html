<div id="org-section">
  <div class="organization-list-container">
    <h2>My Organizations</h2>
    <div *ngIf="loading" style="padding: 1rem; color: #666;">Loading your organizations...</div>

    <!-- User's Organizations -->
    <div *ngIf="!loading && organizations.length > 0" class="org-grid">
      <div *ngFor="let org of organizations" class="org-card" (click)="goToOrg(org)" tabindex="0">
        <div class="org-card-header">
          <h3 class="org-card-name">{{ org.name }}</h3>
          <span class="org-actions">
            <button class="icon-btn edit-btn" (click)="startEdit(org); $event.stopPropagation();" title="Edit">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#1976d2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 1 1 3 3L7 19l-4 1 1-4 12.5-12.5z"/></svg>
            </button>
            <button class="icon-btn delete-btn" (click)="deleteOrg(org); $event.stopPropagation();" title="Delete">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#e53935" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m5 0V4a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2"/><line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/></svg>
            </button>
          </span>
        </div>

        <div *ngIf="org.editing" class="edit-form">
          <form [formGroup]="org.editForm" (ngSubmit)="saveOrg(org)">
            <input formControlName="name" placeholder="Organization Name" />
            <button type="submit" [disabled]="org.editForm.invalid || loading">Save</button>
            <button type="button" (click)="cancelEdit(org)">Cancel</button>
          </form>
        </div>
      </div>
    </div>

    <!-- Empty state for users with no organizations -->
    <div *ngIf="!loading && organizations.length === 0" class="empty-state" style="padding: 2rem; text-align: center; background: #f5f5f5; border-radius: 8px; margin: 1rem 0;">
      <h3 style="color: #666; margin-bottom: 0.5rem;">You don't have any organizations yet</h3>
      <p style="color: #999; margin-bottom: 1rem;">Create a new organization or browse existing ones to request access</p>
    </div>

    <h3>Create Organization</h3>
    <form [formGroup]="createOrgForm" (ngSubmit)="createOrganization()">
      <input formControlName="name" placeholder="Organization Name" />
      <button type="submit" [disabled]="createOrgForm.invalid || loading">Create</button>
    </form>

    <div class="browse-section" style="margin-top: 2rem;">
      <h3>Browse All Organizations</h3>
      <p style="color: #666; margin-bottom: 1rem;">Request access to organizations you'd like to join</p>

      <div class="all-orgs-section">
        <div *ngIf="allOrganizations.length === 0" style="padding: 1rem; color: #999; text-align: center;">
          Loading available organizations...
        </div>
        <div class="org-grid" *ngIf="allOrganizations.length > 0">
          <div *ngFor="let org of allOrganizations" class="org-card" [class.member]="org.isMember">
            <div class="org-card-header">
              <h3 class="org-card-name">{{ org.name }}</h3>
              <span *ngIf="org.isMember" class="member-badge">✓ Member</span>
            </div>
            <div class="org-card-actions">
              <button 
                *ngIf="org.isMember" 
                class="btn-view"
                (click)="goToOrg(org)">
                View
              </button>
              <button 
                *ngIf="!org.isMember && !org.hasRequestedAccess" 
                class="btn-request"
                (click)="requestAccess(org)">
                Request Access
              </button>
              <span 
                *ngIf="!org.isMember && org.hasRequestedAccess" 
                class="pending-badge">
                ⏳ Request Pending
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
