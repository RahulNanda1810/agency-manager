<!-- Organization Detail Component -->
<div class="organization-detail-container">
  <!-- Header -->
  <div class="org-header">
    <h2>{{ orgName }}</h2>
    <p class="org-subtitle">Organization Management</p>
  </div>

  <!-- Tab Navigation -->
  <div class="tabs">
    <!-- Clients Tab -->
    <button 
      class="tab-btn"
      [class.active]="activeTab === 'clients'"
      (click)="setActiveTab('clients')">
      ğŸ¢ Clients
    </button>
    
    <!-- Members Tab - Visible to all -->
    <button 
      class="tab-btn"
      [class.active]="activeTab === 'members'"
      (click)="setActiveTab('members')">
      ğŸ‘¥ Members
    </button>
        
    <!-- Invitations Tab - Admin only -->
    <button 
      *ngIf="isAdmin()"
      class="tab-btn"
      [class.active]="activeTab === 'invitations'"
      (click)="setActiveTab('invitations')">
      âœ‰ï¸ Invitations
      <span *ngIf="invitations.length > 0" class="badge">{{ invitations.length }}</span>
    </button>
        
    <!-- Requests Tab - Admin only -->
    <button 
      *ngIf="isAdmin()"
      class="tab-btn"
      [class.active]="activeTab === 'requests'"
      (click)="setActiveTab('requests')">
      ğŸ“¨ Requests
      <span *ngIf="accessRequests.length > 0" class="badge alert">{{ accessRequests.length }}</span>
    </button>
  </div>

  <!-- Success/Error Messages -->
  <div *ngIf="successMessage" class="success-message">
    {{ successMessage }}
  </div>
  <div *ngIf="errorMessage" class="error-message">
    {{ errorMessage }}
  </div>

  <!-- Tab Content -->
  <div class="tab-content">
    
    <!-- CLIENTS TAB -->
    <div *ngIf="activeTab === 'clients'" class="clients-view">
      <app-client-list [orgId]="orgId"></app-client-list>
    </div>
        
    <!-- MEMBERS TAB -->
    <div *ngIf="activeTab === 'members'" class="members-view">
      <div class="members-header">
        <h3>Organization Members</h3>
        <span class="member-count">{{ members.length }} member(s)</span>
      </div>

      <!-- Members List -->
      <div class="members-list">
        <div *ngFor="let member of members" class="member-card">
          <div class="member-info">
            <div class="member-avatar">
              {{ member.email.charAt(0).toUpperCase() }}
            </div>
            <div class="member-details">
              <div class="member-email">{{ member.email }}</div>
              <div class="member-name" *ngIf="member.name">{{ member.name }}</div>
              <div class="member-joined">Joined {{ member.joinedAt | date:'shortDate' }}</div>
            </div>
          </div>
          <div class="member-actions">
            <span class="role-badge" [class.admin]="member.role === 'org_admin'">
              {{ member.role === 'org_admin' ? 'ğŸ‘‘ Admin' : 'ï¿½ï¿½ Member' }}
            </span>
            <button 
              *ngIf="isAdmin() && member.role !== 'org_admin'"
              class="btn-remove"
              (click)="removeMember(member)">
              Remove
            </button>
          </div>
        </div>

        <!-- Empty State -->
        <div *ngIf="members.length === 0" class="empty-state">
          <p>No members yet</p>
        </div>
      </div>
    </div>

    <!-- INVITATIONS TAB (Admin Only) -->
    <div *ngIf="activeTab === 'invitations'" class="invitations-view">
      <h3>Invite New Members</h3>
      
      <!-- Send Invitation Form -->
      <div class="invite-form">
        <h4>Send Invitation by Email</h4>
        <div class="form-row">
          <input 
            type="email"
            [(ngModel)]="inviteEmail"
            placeholder="email@example.com"
            class="email-input"
            [disabled]="loading"
          />
          <select [(ngModel)]="inviteRole" class="role-select" [disabled]="loading">
            <option value="member">Member</option>
            <option value="org_admin">Admin</option>
          </select>
          <button 
            class="btn-primary"
            (click)="sendInvitation()"
            [disabled]="loading || !inviteEmail.trim()">
            {{ loading ? 'Sending...' : 'ğŸ“§ Send Invite' }}
          </button>
        </div>
      </div>

      <!-- Pending Invitations List -->
      <div class="invitations-list">
        <h4>Pending Invitations</h4>
        
        <div *ngFor="let invitation of invitations" class="invitation-card">
          <div class="invitation-info">
            <div class="invitation-email">{{ invitation.email }}</div>
            <div class="invitation-details">
              <span class="role-badge" [class.admin]="invitation.role === 'org_admin'">
                {{ invitation.role === 'org_admin' ? 'ğŸ‘‘ Admin' : 'ğŸ‘¤ Member' }}
              </span>
              <span class="invitation-meta">
                Sent by {{ invitation.invitedBy?.email || 'Admin' }} â€¢ 
                Expires {{ invitation.expiresAt | date:'short' }}
              </span>
            </div>
          </div>
          <button class="btn-copy" (click)="copyInviteLink(invitation)">
            ğŸ“‹ Copy Link
          </button>
        </div>

        <!-- Empty State -->
        <div *ngIf="invitations.length === 0" class="empty-state">
          <p>No pending invitations</p>
        </div>
      </div>
    </div>

    <!-- REQUESTS TAB (Admin Only) -->
    <div *ngIf="activeTab === 'requests'" class="requests-view">
      <h3>Access Requests</h3>
      <p class="subtitle">Users requesting to join this organization</p>
      
      <!-- Requests List -->
      <div class="requests-list">
        <div *ngFor="let request of accessRequests" class="request-card">
          <div class="request-info">
            <div class="request-user">
              <div class="user-avatar">
                {{ request.userId.email.charAt(0).toUpperCase() }}
              </div>
              <div>
                <div class="user-email">{{ request.userId.email }}</div>
                <div class="user-name" *ngIf="request.userId.name">{{ request.userId.name }}</div>
              </div>
            </div>
            <div *ngIf="request.message" class="request-message">
              "{{ request.message }}"
            </div>
            <div class="request-date">
              Requested {{ request.createdAt | date:'short' }}
            </div>
          </div>
          <div class="request-actions">
            <button class="btn-approve" (click)="respondToRequest(request, 'approve')">
              âœ“ Approve
            </button>
            <button class="btn-reject" (click)="respondToRequest(request, 'reject')">
              âœ• Reject
            </button>
          </div>
        </div>

        <!-- Empty State -->
        <div *ngIf="accessRequests.length === 0" class="empty-state">
          <p>No pending access requests</p>
        </div>
      </div>
    </div>

  </div>
</div>
